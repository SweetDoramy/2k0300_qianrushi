# JJpi_linux
smartcar_jiujiupai

*2025/3/29*
测试了编码器，舵机的一些参数，写了电机闭环但是没法测试；下一步先整摄像头.
需要搞清楚编码器测的什么值，和占空比的比例关系；舵机的角度与占空比的关系，以及pid怎么闭环；陀螺仪怎么测试？目前想的是用vofa+来做测试。摄像头毫无头绪。

*2025/4/5*
搞懂了舵机原理，写完了舵机闭环；电机编码器正在测试，要用方向编码器T法测速；图像识别良好，可以进行图像处理了；板卡无线不太顺利，连上了但是老是中断，还把我VScode的SSH搞断了，找原因中.

*2025/4/10*
实现了最基本的舵机闭环，但是只取了某一行的中线，pid调参也不怎么行，图像也有点卡壳，所有现在只能直线摇摇摆摆地向前；电机闭环编码器打算用实验计算值，需要时时调整，而且目前没有验证。

*2025/4/19*
目前舵机闭环挺好，需要根据图像、速度不同情况进行pid调参；电机用开环可以跑了，而且比较丝滑；按键写好了，并且可以用按键改值；图像和参数也都已经打印到屏幕上面了。接下来就是电机闭环跑和负压跑调电调的参数，还有陀螺仪测试。

*2025/5/1*
正在研究PID中，按键进行了补充

*2025/5/14*
陀螺仪写好了，就是对应关系可能需要加倍数吧，只用了pitch和roll,打算把陀螺仪侧着装;另外测试了负压电调，可以直接用,在suction函数里面

*2025/5/19*
陀螺仪补充上了偏航角yaw值，并写好了积分函数。开始积分后，如果偏转角度大于一个阈值yaw_T，则标志位yaw_end_flag置1,用于圆环图像处理,具体函数均在
imu.cpp里面。经过测试，运行良好。

*2025/6/2*
给编码器的波形加了一道滤波，波形平滑了许多，但是pid实际值对目标值的跟踪的误差波动还是在30左右,即6%.改了改闭环代码.

*2025/6/3*
整体捋了一下线程之间的逻辑，九九派是单核双发射，但是重点在单核，不管怎么修改线程逻辑还是会竞争，要保证不卡死刷新率正常就得牺牲掉响应，频率设置低一点，这样各线程之间就不会相互阻塞了。自己补充了一个定时器逻辑，只开一个辅助线程且精确控制周期的版本，各个定时任务之间是串行关系，需要保证频率不能太高，否则就会一直被高频任务阻塞。图像处理还是太耗时了，打算单开。

*2025/6/14*
换了龙邱的摄像头，帧率提上去了，不怎么卡顿了。然后就是过弯内外切的问题，这里打算改中线前瞻，看到底走哪种策略。另外，C车的结构影响转弯，打算切一点。